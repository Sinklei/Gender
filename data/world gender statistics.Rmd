---
title: "World Gender Statistics"
author: "Linda Sinani"
date: "28 6 2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(ggplot2)
library(dplyr)

world_gender_stat <- readr::read_csv('C:/Users/rizab/OneDrive/Desktop/Data.csv.zip') 

aggregate.states = c("ARB","CEB","CSS","EAP","EAR","EAS","ECA","ECS","EMU","EUU","FCS","HIC","HPC","IBD","IBT","IDA","IDB","IDX","LAC","LCN","LDC","LIC","LMC","LMY","LTE","MEA","MIC","MNA","NAC","OED","OSS","PRE","PSS","PST","SAS","SSA","SSF","SST","TEA","TEC","TLA","TMN","TSA","TSS","UMC","WLD")
 
gender <- world_gender_stat %>%
    filter(!(Country.Code %in% aggregate.states)) 

gender.fem.perc <- gender %>%
    filter(Indicator.Code == "SP.POP.TOTL.FE.ZS")


gender.perc.long <- gender.fem.perc %>%
    gather(year, percent.f, 5:61) %>%
    mutate(year = as.numeric(substr(year, 2, 5))) %>%
    filter(!is.na(percent.f))

gender.extremes = gender.perc.long %>%
  filter(percent.f %in% c(max(percent.f), min(percent.f)))

year.counts <- gender.perc.long %>%
  group_by(year) %>%
  summarize(ncountries = length(Country.Name))

biggest.year <- year.counts %>%
  filter(ncountries == max(ncountries))

print(biggest.year)

gender.perc.2010 <- gender.perc.long %>%
  filter(year==2010)

gender.perc.2010 %>%
  ggplot(aes(x=Country.Name, y=percent.f)) +
    geom_bar(stat="identity") +
    theme(axis.text.x = element_text(angle = 90, hjust = 1))


fem.perc.5percentile <- with(gender.perc.2010, quantile(percent.f, 0.05))
fem.perc.95percentile <- with(gender.perc.2010, quantile(percent.f, 0.95))

fem.perc.outliers <- gender.perc.2010 %>%
  filter(percent.f >= fem.perc.95percentile | percent.f <= fem.perc.5percentile)

fem.perc.outliers %>%
  ggplot(aes(x=reorder(Country.Name, percent.f), y=percent.f)) +
    geom_bar(stat="identity") +
    theme(axis.text.x = element_text(angle = 90, hjust = 1))


```


