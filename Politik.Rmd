---
title: "Politik"
author: "Kevin"
date: "7/26/2021"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(dplyr)
library(packcircles)

```

```{r datensätze, include=TRUE}
# datensätze einlesen und cleanen/ordnen


##### SEATS #####

# datensatz zeigt prozente von frauen in parlamenten aus verschiedenen ländern


before_clean_seats <- read.csv("data/raw/before_clean_seats_parliaments.csv", check.names = F)

seats <- before_clean_seats %>% 
            filter(country != "") %>% 
            pivot_longer(cols = -country, names_to = "year", values_to = "n") %>% 
            mutate_if(is.numeric, round) %>% 
            filter(n != "NA") %>% 
            filter(!country %in% c("Africa Eastern and Southern",
                                   "Africa Western and Central",
                                   "Arab World",
                                   "Central Europe and the Baltics",
                                   "Caribbean small states",
                                   "Early-demographic dividend",
                                   "East Asia & Pacific",
                                   "East Asia & Pacific (excluding high income)",
                                   "East Asia & Pacific (IDA & IBRD)",
                                   "Euro area",
                                   "Europe & Central Asia",
                                   "Europe & Central Asia (excluding high income)",
                                   "Europe & Central Asia (IDA & IBRD)",
                                   "European Union",
                                   "Fragile and conflict affected situations",
                                   "Heavily indebted poor countries (HIPC)",
                                   "High income",
                                   "IBRD only",
                                   "IDA & IBRD total",
                                   "IDA blend",
                                   "IDA only",
                                   "IDA total",
                                   "Late-demographic dividend",
                                   "Latin America & Caribbean",
                                   "Latin America & Caribbean (excluding high income)",
                                   "Latin America & Caribbean (IDA & IBRD)",
                                   "Least developed countries: UN classification",
                                   "Low & middle income",
                                   "Low income",
                                   "Lower middle income",
                                   "Middle East & North Africa",
                                   "Middle East & North Africa (excluding high income)",
                                   "Middle East & North Africa (IDA & IBRD)",
                                   "Middle income",
                                   "North America",
                                   "OECD members",
                                   "Other small states",
                                   "Pacific island small states",
                                   "Post-demographic dividend",
                                   "Pre-demographic dividend",
                                   "Small states",
                                   "South Asia",
                                   "South Asia (IDA & IBRD)",
                                   "Sub-Saharan Africa",
                                   "Sub-Saharan Africa (excluding high income)",
                                   "Sub-Saharan Africa (IDA & IBRD)",
                                   "Upper middle income",
                                   "World"))


names(seats)[1] <- "country"
names(seats)[3] <- "percentage"
seats$year <- as.numeric(seats$year)



#### 1 bundestag ####

# selbst generierter Datensatz aus Wikipedia Tabelle (https://de.wikipedia.org/wiki/Frauenanteil_im_Deutschen_Bundestag_seit_1949)
# datensatz zeigt die anzahl/prozente von männern und frauen in den bundestagen an


bundestag_raw <- read.csv("data/to_work_with/bundestagzusammensetzung.csv") %>% 
                  mutate(maenner_anzahl = (mitglieder-frauen_anzahl),
                          maenner_perc = (100-frauen_perc))

bundestag <- bundestag_raw[c(1,2,3,7,6,4,5)]

# cleaning: ordinale variable für bundestag

scale.bundestag <- c("1. Bundestag 1949-1953",
                     "2. Bundestag 1953-1957",
                     "3. Bundestag 1957-1961",
                     "4. Bundestag 1961-1965",
                     "5. Bundestag 1965-1969",
                     "6. Bundestag 1969-1972",
                     "7. Bundestag 1972-1976",
                     "8. Bundestag 1976-1980",
                     "9. Bundestag 1980-1983",
                     "10. Bundestag 1983-1987",
                     "11. Bundestag 1987-1990",
                     "12. Bundestag 1990-1994",
                     "13. Bundestag 1994-1998",
                     "14. Bundestag 1998-2002",
                     "15. Bundestag 2002-2005",
                     "16. Bundestag 2005-2009",
                     "17. Bundestag 2009-2013",
                     "18. Bundestag 2013-2017",
                     "19. Bundestag 2017-2021",
                     "20. Bundestag 2021"
                     )

bundestag$bundestag <- ordered(bundestag$bundestag, levels = scale.bundestag)

view(bundestag)


#### 2 parteien_frauen ####

# selbst generierter Datensatz aus Wikipedia Tabelle (https://de.wikipedia.org/wiki/Frauenanteil_im_Deutschen_Bundestag_seit_1949)
# datensatz zeigt die anzahl/prozente von Frauen in den einzelnen Parteien


parteien_frauen <- read.csv("data/to_work_with/zusammensetzung_frauen_parteien.csv")


# kann man vielleicht hinzufügen, wenn es genug daten geben sollte.
#mutate(maenner_anzahl = (mitglieder-frauen_anzahl),
#maenner_perc = (100-frauen_perc))


# cleaning: ordinale variable für bundestag

parteien_frauen$bundestag <- ordered(parteien_frauen$bundestag, levels = scale.bundestag)

view(parteien_frauen)
```

# Einleitungstext

* Statista. geschlechtliche Ungerechtigkeit in der Bundestagszusammensetzung etc.
* googlen nach allgemeinem Meinungsbild zu Männer und Frauen Verteilung in der Politik
* artikel von tagesschau zur zusammensetzung von männern und frauen im neuen bundestag
* was gibt es sonst noch zum neuen bundestag?
* Artikel und Dokumente von der Bundestagswebsite selbst

"wir haben die bundestagswahl 2021 hinter uns. so sieht es bei uns in deutschland aus. wie sieht es in der ganzen welt aus??"



# seats in parliament


* bubble plot
* mit dieser Visualisierung starten können, um einen allgemeinen Überblick über die Lage in der Welt geben zu können (von kleinem zum großen gehen können)
* Achtung: das sind nur Prozente


* was sind die markantesten werte
* mittelwert über die ganzen Länder vielleicht machen? (arithmetisches mittel)
* welches ist das mittigste land
* wenn ich mittelwerte bilde muss ich das kontrollieren mit einträgen wie "arab world" "world" und sowas
* vielleicht bereiche der welt miteinander vergleichen wie "arab world" und "pacific" und "euro area"

```{r seats 2020}

seats_2020 <- seats %>% filter(year == "2020")
  
seats_2020 %>% 
  ggplot() +
  aes(x = year,
      y = percentage) +
  geom_boxplot() +
  #geom_point(alpha=0.1) +
  coord_flip() +
  geom_hline(yintercept = 31, color = "red", size = 1) +
  geom_hline(yintercept = 50, color = "blue", size = 1) +
  scale_y_continuous(limits = c(0, 100)) +
  NULL



seats_2020 %>% 
  ggplot() +
  aes(y = percentage) +
  geom_histogram(bins = 237) +
  coord_flip() +
  geom_hline(yintercept = 31, color = "red", size = 1) +
  geom_hline(yintercept = 50, color = "blue", size = 1) +
  scale_y_continuous(limits = c(0, 100))



## austesten können
seats_2020 %>% 
  ggplot() +
  aes(x = country,
      y = percentage) +
  geom_col() +
  coord_flip() +
  geom_hline(yintercept = 31, color = "red", size = 1) +
  geom_hline(yintercept = 50, color = "blue", size = 1) +
  scale_y_continuous(limits = c(0, 100))

## vielleicht so einen bar plot der verständlich ist????


```


für year == 2020 ist die Anzahl an Ländern 190
der schlechteste wert in 2020 ist 0, der beste 61 prozent (range)

das land mit der höchsten prozentzahl ist rwanda (61%), dann kommt Kuba (53%) und dann die Vereinigten Arabischen Emirate (50%)
länder mit einem wert von 0 prozent sind Micronesia, Papua New Guinea, Vanuatu und Yemen.


"die verteilung unter den geschlechtern in der politik ist weit davon entfernt, gerecht bei 50% zu sein. ein paar wenige ausnahmeländer haben mehr frauen in ihren parlamenten als männer. die deutliche mehrzahl der parlamente ist männerdominiert. deutschland liegt bei 31%" (ist das so, kontrollieren)
die wenigsten länder kommen überhaupt in die 50 prozent nähe. politik ist immer noch ein vorwiegend durch männer geprägter bereich


mittelwert über die ganze welt in 2020 23,865 prozent (median 23)
Länder, die den Median widerspiegeln: Armenien, Chile, Malawi, Panama



Unser Ziel erst mal: einfach nur zeigen wie es auf der welt ist
schlussfolgerung, da müsste sich also was tun, wenn es das ziel ist, dass man das ausgleichen will (wo ist das vielleicht das ziel? so ein EU Ding??? Regularien Gesetze???)


mit dem bubble plot verschiedene länder zeigen können, was es halt so gibt

```{seats bubble plot, r}

library(packcircles)

# Create data (dataframe to work with)
seats_bubble <- seats %>% filter(year == "2020",
                                 country %in% c("Germany", "Rwanda", "Cuba", "United Arab Emirates", "Yemen, Rep.", "Papua New Guinea", "Micronesia, Fed. Sts.", "Malawi", "Panama", "Armenia", "Maldives", "Japan", "Kiribati", "France", "Sweden"))

# Generate the layout. This function return a dataframe with one line per bubble. 
# It gives its center (x and y) and its radius, proportional of the value
seats_packing <- circleProgressiveLayout(seats_bubble$percentage, sizetype = "area")

# We can add these packing information to the initial data frame
seats_bubble <- cbind(seats_bubble, seats_packing)

# Check that radius is proportional to value. We don't want a linear relationship, since it is the AREA that must be proportionnal to the value
#plot(seats_bubble$radius, seats_bubble$number)

# The next step is to go from one center + a radius to the coordinates of a circle that
# is drawn by a multitude of straight lines.
seats.gg <- circleLayoutVertices(seats_packing, npoints = 50)


# dass man vernünftig die zahlen da reinbekommt
seats_bubble_label <- seats_bubble %>% 
                        mutate(y = y-0.6)

# generate the plot
ggplot() +
  
  # bubble
  geom_polygon(data = seats.gg, aes(x, y, group = id, fill = as.factor(id), color = "black", alpha = 0.6)) +
  
   # Add text in the center of each bubble + control its size
  geom_text(data = seats_bubble, aes(x, y, size = percentage, label = country)) +
  geom_text(data = seats_bubble_label, aes(x, y, size = percentage, label = percentage)) +
  scale_size_continuous(range = c(1,4)) +
  
  # General theme:
  theme_void() + 
  theme(legend.position="none") +
  coord_equal()

```






* 1997 bis 2020
wie oben gezeigt wurde es ist bei weitem noch nicht gleich, aber es hat sich sehr positiv entwickelt
* wie hat sich das so entwickelt?
* kann man einen Trend erkennen?





Hintergrundinfos über den Datensatz:
Proportion of seats held by women in national parliaments (%)(SG.GEN.PARL.ZS)
Definition: Women in parliaments are the percentage of parliamentary seats in a single or lower chamber held by women.
Quelle: Inter-Parliamentary Union (IPU) (www.ipu.org). For the year of 1998, the data is as of August 10, 1998.
aggregation method: Weighted average

meine Quelle: https://databank.worldbank.org/source/gender-statistics

könnte auch mit Bildung zusammenhängen, dass für Frauen nicht dieselben Voraussetzungen gelten wie für Männer


```{seats, r}


# 1997 - 2020 HIER WAR ICH DRAN

seats %>% 
  ggplot() +
  aes(x = year,
      y = percentage) +
  geom_point(alpha = 0.1)






# allgmeine oder so
view(seats)

range(seats$percentage)

o <- seats %>% 
  filter(percentage == "0")

view(o)

z <- c("Bahrain", "Belize", "Comoros", "Djibouti", "Haiti", "Jordan", "Kiribati", "Kuwait", "Kyrgyz Republic", "Micronesia, Fed. Sts.", "Nauru", "Oman", "Palau", "Papua New Guinea", "Qatar", "Saudi Arabia", "Solomon Islands", "St. Kitts and Nevis", "St. Lucia", "Tonga", "Tuvalu", "United Arab Emirates", "Vanuatu", "Yemen, Rep.")


seats %>% 
  filter(country == "Belize") %>% 
  ggplot() +
  aes(x = year,
      y = percentage) +
  geom_point()

```

```{seats datenlage checken, r}

# Datenlage checken

seats %>% 
  filter(country %in% c("Germany", "Afghanistan", "Angola", "Bahrain")) %>% 
  ggplot() +
  aes(x = year, 
      y = percentage,
      color = country) +
  geom_point() +
  NULL


seats %>% 
  ggplot() +
  aes(x = as.character(year),
      y = percentage) +
  geom_jitter(alpha = 0.1) +
  geom_boxplot()



seats %>%
  filter(year == "2020") %>% 
  ggplot() +
  aes(x = year,
      y = percentage) +
  geom_boxplot() +
  geom_jitter(alpha = 0.4) +
  coord_flip()


seats %>% 
  filter(region == "Rwanda") %>% 
  ggplot() +
  aes(x = year,
      y = percentage) +
  geom_point()


### Welche Lände rkönnte man so nehmen für eine Grafik??
# Deutschland 31, Rwanda (max 61)


# max Rwanda 64
# min mehrere Länder mit 0 (auch Papa dings da)
# mean liegt bei 17 ca
# median bei 16
# sd bei 10

o <- seats %>% 
      filter(year == "2020",
             #percentage == "61",
             country == "Germany")

view(o)

seats %>% 
  filter(percentage > 40) %>% count()
  ggplot() +
  aes(x = year,
      y = percentage) +
  geom_jitter()

view(seats)


max(o$percentage)
min(seats$percentage)
mean(seats$percentage)
median(seats$percentage)
sd(seats$percentage)
range(seats$percentage)

seats %>% count(percentage, sort = T)
```





# aktueller Bundestag

yeah



# Zusammensetzung Bundestag 

man kann zeigen, dass sich über die Zeit die Anzahl an Frauen im Bundestag erhöht hat
noch einzeichnen können:
* wahlperiode
* prozent der frauen, prozent der männer
* verteilung von frauen und männern?


wahlperiode komplett weg machen?? bzw wie am besten einsetzen?
mehrere geome in einen plot kriegen(vielleicht sogar zwei achsen.??)
wie kann ich das umsetzen, dass die daten nicht doppelt sind? ggf datensatz umbauen? mit hovern zum beispiel zusätzliche infos?

vor allen dingen auch verteilung gegenüber männer zeigen

zeitliche achse ist die y achse und geht von oben nach unten, so wie die website auch gestaltet ist
wichtig ist es zu zeigen, dass sich die anzahl und prozent an frauen über die jahre gesteigert hat, jedoch im vergleich zu den männern immer noch sehr klein ist


in eine grafik kriegen

* y achse bundestag in richtiger reihenfolge von oben nach unten
* frauen und männer anzahl
* vielleicht noch irgendwie prozente reinbringen
* gesamt mitgliederanzahl
* auf wahlperiode scheissen?? nur eine nehmen??


```{r}

bundestag %>%
  ggplot() +
  geom_point(mapping = aes(x = bundestag, y = frauen_anzahl, color = wahlperiode)) +
  geom_point(mapping = aes(x = bundestag, y = maenner_anzahl, color = wahlperiode)) +
  geom_point(mapping = aes(x = bundestag, y = mitglieder)) +
  coord_flip()
  NULL


  view(bundestag)
bundestag %>% 
  filter(wahlperiode == "beginn") %>% 
  ggplot() +
  aes(x = bundestag,
      y = frauen_perc) +
  geom_point()
  
  


```

# Frauenanteil in den Parteien

parteimitglieder noch ergänzen?
jahre vielleicht ganz raus machen (datensatz erneuern, oder einfach commands nutzen?)
bundestag mit order (ordinale variable)
noch weitere daten dann suchen

sitzeverteilung der einzelnen bundestage vielleicht ergänzen


gibt es daten zu der anzahl der parteien und den anzahl der männer
missing values herausfindne können?

```{r}
parteien_frauen %>%
  ggplot() +
  aes(
    x = bundestag,
    y = frauen_anzahl,
    color = partei
  ) +
  geom_point() +
  coord_flip()
  NULL


  
  
parteien_frauen %>%
  ggplot() +
  aes(
    x = partei,
    y = frauen_anzahl
  ) +
  geom_col() +
  NULL


```






```{r, Bundestag Stammdaten XML}

library(XML)

fileName <- "data/vielleicht/MDB_STAMMDATEN.XML"
xmlData <- xmlInternalTreeParse(fileName)

print(xmlData)

xmlDataFrame <- xmlToDataFrame(xmlData)

xmlDataFrame %>% view()










```


