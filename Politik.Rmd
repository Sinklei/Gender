---
title: "Politik"
author: "Kevin"
date: "7/26/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(dplyr)


# datensätze einlesen und cleanen/ordnen

bt_frauen <- read.csv("data/to_work_with/bundestagzusammensetzung.csv") %>% 
                mutate(maenner_anzahl = (mitglieder-frauen_anzahl),
                       maenner_perc = (100-frauen_perc))

bt <- bt_frauen[c(1,2,3,7,6,4,5)]



parteien_frauen <- read.csv("data/to_work_with/zusammensetzung_frauen_parteien.csv")

```
was wäre cool zu visualisieren?
wie sich das im laufe der zeit verändert hat? mit den bundestagen an sich?
verteilung dann von männern und frauen zeigen

verteilung innerhalb der parteien zeigen und wie sich diese im laufe der zeit verändert haben.

größe der parteien??




# Infotext

Statista. geschlechtliche Ungerechtigkeit in der Bundestagszusammensetzung etc.
googlen nach allgemeinem Meinungsbild zu Männer und Frauen Verteilung in der Politik


# seats in parliament

DAS SIND NUR PROZENTE, um das besser einordnen zu können wären Gesamtzahlen und davon dann Anteil Frauen natürlich sehr sinnvoll, aber das kriegt man bestimmt nicht hin, vor allem weil das ja schon übel schwer ist, das für Deutschland herauszufinden

Hintergrundinfos:
Proportion of seats held by women in national parliaments (%)(SG.GEN.PARL.ZS)
Definition: Women in parliaments are the percentage of parliamentary seats in a single or lower chamber held by women.
Quelle: Inter-Parliamentary Union (IPU) (www.ipu.org). For the year of 1998, the data is as of August 10, 1998.
aggregation method: Weighted average

meine Quelle: https://databank.worldbank.org/source/gender-statistics

könnte auch mit Bildung zusammenhängen, dass für Frauen nicht dieselben Voraussetzungen gelten wie für Männer


```{r}
# SEATS DATENSATZ VORBEREITEN

before_clean_seats <- read.csv("data/raw/before_clean_seats_parliaments.csv", check.names = F)

seats <- before_clean_seats %>% 
            filter(country != "") %>% 
            pivot_longer(cols = -country, names_to = "year", values_to = "n") %>% 
            mutate_if(is.numeric, round) %>% 
            filter(n != "NA")

names(seats)[1] <- "region"
names(seats)[3] <- "number"

```


```{r}
# MAP


# Check all available geospatial objects:
# help(package='maps')

library(maps)

# Map of the world:
map('world',col="grey", fill=TRUE, bg="white", lwd=0.05, mar=rep(0,4),border=0, ylim=c(-80,80))

mapdata <- map_data("world")

seats_map <- full_join(mapdata, seats, by = "region")

seats_map1 <- seats_map %>% filter(!is.na(seats_map$number))




map1 <- ggplot(seats_map,
        aes(x = long, y = lat, group = group)) +
        geom_polygon(aes(fill = number), color = "black")

map2 <- map1 + scale_fill_gradient(name = "Anzahl an Frauen im Parlament", low = "skyblue", high = "red", na.value = "grey50") +
         theme(axis.text.x = element_blank(),
                axis.text.y = element_blank(),
                axis.ticks = element_blank(),
                axis.title.x = element_blank(),
                axis.title.y = element_blank(),
                rect = element_blank())

map2

```


```{r}
# BUBBLE

seats %>% view()


seats %>% 
  filter(region %in% c("Germany", "Afghanistan", "Angola", "Bahrain")) %>% 
  ggplot() +
  aes(x = year, 
      y = number,
      color = region) +
  geom_point() +
  NULL



o <- seats %>% 
      filter(number == "40")


view(o)

max(seats$number)
min(seats$number)
mean(seats$number)
median(seats$number)
sd(seats$number)
range(seats$number)

seats %>% count(number, sort = T)

### Welche Lände rkönnte man so nehmen für eine Grafik??
# Deutschland 
# max Rwanda 64
# min mehrere Länder mit 0 (auch Papa dings da)
# mean liegt bei 17 ca
# median bei 16
# sd bei 10



seats %>% 
  ggplot() +
  aes(x = year,
      y = number) +
  geom_jitter(alpha = 0.1) +
  geom_boxplot()

seats %>%
  filter(year == "2020") %>% 
  ggplot() +
  aes(x = year,
      y = number) +
  geom_jitter(alpha = 0.1) +
  coord_flip()


seats %>% 
  filter(region == "Germany") %>% 
  ggplot() +
  aes(x = year,
      y = number) +
  geom_point()

```



# aktueller Bundestag

yeah



# Zusammensetzung Bundestag 

man kann zeigen, dass sich über die Zeit die Anzahl an Frauen im Bundestag erhöht hat
noch einzeichnen können:
* wahlperiode
* prozent der frauen, prozent der männer
* verteilung von frauen und männern?


wahlperiode komplett weg machen?? bzw wie am besten einsetzen?
mehrere geome in einen plot kriegen(vielleicht sogar zwei achsen.??)
wie kann ich das umsetzen, dass die daten nicht doppelt sind? ggf datensatz umbauen? mit hovern zum beispiel zusätzliche infos?

vor allen dingen auch verteilung gegenüber männer zeigen

zeitliche achse ist die y achse und geht von oben nach unten, so wie die website auch gestaltet ist
wichtig ist es zu zeigen, dass sich die anzahl und prozent an frauen über die jahre gesteigert hat, jedoch im vergleich zu den männern immer noch sehr klein ist


in eine grafik kriegen

* y achse bundestag in richtiger reihenfolge von oben nach unten
* frauen und männer anzahl
* vielleicht noch irgendwie prozente reinbringen
* gesamt mitgliederanzahl
* auf wahlperiode scheissen?? nur eine nehmen??


```{r}

bt %>%
  ggplot() +
  geom_point(mapping = aes(x = bundestag, y = frauen_anzahl, color = wahlperiode)) +
  geom_point(mapping = aes(x = bundestag, y = maenner_anzahl, color = wahlperiode)) +
  geom_point(mapping = aes(x = bundestag, y = mitglieder)) +
  coord_flip()
  NULL


bt %>% 
  ggplot() +
  aes(x = bundestag,
      y = frauen_perc) +
  geom_point() +
  coord_flip()
  
  


```

# Frauenanteil in den Parteien

parteimitglieder noch ergänzen?
jahre vielleicht ganz raus machen (datensatz erneuern, oder einfach commands nutzen?)
bundestag mit order (ordinale variable)
noch weitere daten dann suchen

sitzeverteilung der einzelnen bundestage vielleicht ergänzen


gibt es daten zu der anzahl der parteien und den anzahl der männer
missing values herausfindne können?

```{r}
parteien_frauen %>%
  ggplot() +
  aes(
    x = bundestag,
    y = frauen_zahl,
    color = partei
  ) +
  geom_point() +
  coord_flip()
  NULL


  
  
parteien_frauen %>%
  ggplot() +
  aes(
    x = partei,
    y = frauen_zahl
  ) +
  geom_col() +
  NULL


```

